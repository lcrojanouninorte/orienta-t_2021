(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"7ckB":function(e,t,n){"use strict";n.r(t),n.d(t,"StationModule",(function(){return F}));var o=n("mrSG"),i=n("ofXK"),r=n("aceb"),a=n("XhcP"),s=n("lWTH"),c=n("kvL/"),l=n("RS3s"),u=n("tyNb"),d=n("mvqV"),p=n("tk/3"),f=n("vC38"),m=n("ZgVZ"),h=n("fXoL"),v=function(){function e(e){this._stationsService=e}return e.prototype.ngOnInit=function(){},e.prototype.update=function(e){var t=this;this.rowData.state=e.target.checked,this._stationsService.updateStation(this.rowData).subscribe({next:function(e){e?t._stationsService.showToast("top-right","success","Visibilidad Actualizada Correctamente"):t._stationsService.showToast("top-right","error","Ocurrio un error, intente nuevamente")},error:function(e){t._stationsService.showToast("top-right","success",e)}})},e.\u0275fac=function(t){return new(t||e)(h["\u0275\u0275directiveInject"](d.a))},e.\u0275cmp=h["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],inputs:{value:"value",rowData:"rowData"},decls:1,vars:1,consts:[["status","info",3,"checked","change"]],template:function(e,t){1&e&&(h["\u0275\u0275elementStart"](0,"nb-toggle",0),h["\u0275\u0275listener"]("change",(function(e){return t.update(e)})),h["\u0275\u0275elementEnd"]()),2&e&&h["\u0275\u0275property"]("checked","1"==t.rowData.state)},directives:[r.Sb],encapsulation:2}),e}(),b=n("9OXO"),g=function(e){return[e]},w=function(){function e(e){this._dialogService=e}return e.prototype.ngOnInit=function(){this.url=this.rowData.id+this.linkUrl},e.prototype.openWindow=function(){this._dialogService.open(b.a,{context:{_marker:this.rowData}})},e.\u0275fac=function(t){return new(t||e)(h["\u0275\u0275directiveInject"](r.I))},e.\u0275cmp=h["\u0275\u0275defineComponent"]({type:e,selectors:[["ng-component"]],inputs:{value:"value",linkUrl:"linkUrl",rowData:"rowData"},decls:2,vars:3,consts:[["size","small","shape","round","ghost","","nbButton","","status","success",3,"click"],["width","30",3,"src"]],template:function(e,t){1&e&&(h["\u0275\u0275elementStart"](0,"div",0),h["\u0275\u0275listener"]("click",(function(){return t.openWindow()})),h["\u0275\u0275element"](1,"img",1),h["\u0275\u0275elementEnd"]()),2&e&&(h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("src",h["\u0275\u0275pureFunction1"](1,g,(null==t.rowData.icon?null:t.rowData.icon.base64)||t.rowData.icon),h["\u0275\u0275sanitizeUrl"]))},encapsulation:2}),e}();function y(e,t){if(1&e){var n=h["\u0275\u0275getCurrentView"]();h["\u0275\u0275elementStart"](0,"ngx-dropzone-image-preview",4),h["\u0275\u0275listener"]("removed",(function(){h["\u0275\u0275restoreView"](n);var e=t.$implicit;return h["\u0275\u0275nextContext"]().onRemove(e)})),h["\u0275\u0275element"](1,"ngx-dropzone-label"),h["\u0275\u0275elementEnd"]()}if(2&e){var o=t.$implicit;h["\u0275\u0275property"]("removable",!0)("file",o)}}var S=function(e){function t(t,n){var o=e.call(this)||this;return o._stationService=t,o._toastrService=n,o.files=[],o.index=0,o}return Object(o.c)(t,e),t.prototype.ngAfterViewInit=function(){},t.prototype.onSelect=function(e){var t,n=this;(t=this.files).push.apply(t,e.addedFiles),this.readFile(this.files[0]).then((function(e){n.cell.newValue={base64:""+e,file:n.files[0]}}))},t.prototype.onRemove=function(e){this.files.splice(this.files.indexOf(e),1)},t.prototype.readFile=function(e){return Object(o.b)(this,void 0,void 0,(function(){return Object(o.d)(this,(function(t){return[2,new Promise((function(t,n){var o=new FileReader;if(o.onload=function(e){return t(e.target.result)},o.onerror=function(t){return console.error("FileReader failed on file "+e.name+"."),n(null)},!e)return console.error("No file to read."),n(null);o.readAsDataURL(e)}))]}))}))},t.prototype.showToast=function(e,t,n){this.index+=1,this._toastrService.show(n,"Informaci\xf3n",{limit:3,position:e,status:t})},t.\u0275fac=function(e){return new(e||t)(h["\u0275\u0275directiveInject"](d.a),h["\u0275\u0275directiveInject"](r.Rb))},t.\u0275cmp=h["\u0275\u0275defineComponent"]({type:t,selectors:[["ng-component"]],features:[h["\u0275\u0275InheritDefinitionFeature"]],decls:6,vars:6,consts:[["accept","image/*","maxFileSize","1M",2,"max-height","100px",3,"multiple","id","disabled","change"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"removable","file","removed",4,"ngFor","ngForOf"],[3,"hidden","innerHTML"],["htmlValue",""],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"removable","file","removed"]],template:function(e,t){1&e&&(h["\u0275\u0275elementStart"](0,"ngx-dropzone",0),h["\u0275\u0275listener"]("change",(function(e){return t.onSelect(e)})),h["\u0275\u0275elementStart"](1,"ngx-dropzone-label"),h["\u0275\u0275text"](2,"Imagen (1Mb)"),h["\u0275\u0275elementEnd"](),h["\u0275\u0275template"](3,y,2,2,"ngx-dropzone-image-preview",1),h["\u0275\u0275elementEnd"](),h["\u0275\u0275element"](4,"div",2,3)),2&e&&(h["\u0275\u0275property"]("multiple",!1)("id",t.cell.getId())("disabled",!t.cell.isEditable()),h["\u0275\u0275advance"](3),h["\u0275\u0275property"]("ngForOf",t.files),h["\u0275\u0275advance"](1),h["\u0275\u0275property"]("hidden",!0)("innerHTML",t.cell.getValue(),h["\u0275\u0275sanitizeHtml"]))},directives:[c.a,c.g,i.u,c.b],styles:["ngx-dropzone-image-preview.ng-star-inserted[_ngcontent-%COMP%] {\n       min-height: 70px!important; height: 70px!important;\n    }"]}),t}(l.a),C=n("DqeK"),x=["table"],D=[{path:"",component:function(){function e(e,t,n){var o=this;this._stationsService=e,this._layoutService=t,this._toastrService=n,this.settings={actions:{columnTitle:"Acciones",add:!0,edit:!0,position:"right",delete:!0},hideSubHeader:!1,add:{addButtonContent:'<i class="nb-plus"></i>',createButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>',confirmCreate:!0},edit:{editButtonContent:'<i class="nb-edit"></i>',saveButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>',confirmSave:!0},delete:{deleteButtonContent:'<i class="nb-trash"></i>',confirmDelete:!0,saveButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>'},columns:{icon:{title:"Icono",type:"custom",renderComponent:w,filter:!1,editable:!0,editor:{type:"custom",component:S}},type:{title:"Grupo",type:"text",filter:!0,editable:!0,editor:{type:"custom",component:C.a}},name:{title:"Nombre",type:"text",filter:!0,editable:!0},latitude:{title:"Lat",type:"number",filter:!0,editable:!0},longitude:{title:"Lon",type:"number",filter:!0,editable:!0},state:{title:"Estado",type:"custom",renderComponent:v,filter:!1,editable:!1,editor:{type:"checkbox",config:{true:"1",false:"0"}}}}},this.source=new l.b,this.stations=new Array,this.element=[],this.progress=0,this.index=0,this._stationsService.getRows().subscribe((function(e){o.stations=e,o.source.load(e)})),this._layoutService.changeLayouType("normal")}return e.prototype.ngAfterViewInit=function(){var e=this;this.smartTable.delete.subscribe((function(t){e.onDeleteConfirm(t)}))},e.prototype.actions=function(e,t){e.url=t},e.prototype.onSaveConfirm=function(e){var t=this,n=this._stationsService.toFormData(e.newData);n.append("file",e.newData.icon.file),this.loading=!0,this._stationsService.addStation(n).subscribe({next:function(n){n.type===p.e.UploadProgress&&(t.progress=Math.round(100*n.loaded/n.total)),n.type===p.e.Response&&(t.progress=0,e.newData=(new m.a).deserialize(n.body.station),e.confirm.resolve(e.newData),t.showToast("top left","success","Actualizado correctamente"),t.loading=!1)},error:function(n){t.loading=!1,t.progress=0,t.showToast("top left","danger","Favor revisar si ha llenado todos los campos"),e.confirm.reject()}})},e.prototype.onCreateConfirm=function(e){this.element=e.data,e.confirm.resolve()},e.prototype.onDeleteConfirm=function(e){var t=this;window.confirm("Seguro que desea borrar?  ")?this._stationsService.deleteStation(e.data.id).subscribe({next:function(n){if(n){t.showToast("top-right","success","Borrado Correctamente");var o=t.stations.indexOf(e.data);t.stations.splice(o,1),t.source=new l.b(t.stations),e.confirm.resolve()}else t.showToast("top-right","danger","Error al borrar"),e.confirm.reject()},error:function(n){t.showToast("top-right","danger","Error al borrar"),e.confirm.reject()},complete:function(){}}):e.confirm.reject()},e.prototype.showToast=function(e,t,n){this.index+=1,this._toastrService.show(n,"Informaci\xf3n",{limit:3,position:e,status:t})},e.\u0275fac=function(t){return new(t||e)(h["\u0275\u0275directiveInject"](d.a),h["\u0275\u0275directiveInject"](f.b),h["\u0275\u0275directiveInject"](r.Rb))},e.\u0275cmp=h["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-stations-list"]],viewQuery:function(e,t){var n;1&e&&h["\u0275\u0275viewQuery"](x,!0),2&e&&h["\u0275\u0275queryRefresh"](n=h["\u0275\u0275loadQuery"]())&&(t.smartTable=n.first)},decls:8,vars:5,consts:[["nbSpinnerSize","tiny","nbSpinnerStatus","primary",3,"nbSpinner"],["status","success",3,"value"],[1,"table","table-hover",3,"settings","source","deleteConfirm","editConfirm","createConfirm"],["table",""]],template:function(e,t){1&e&&(h["\u0275\u0275elementStart"](0,"nb-card",0),h["\u0275\u0275elementStart"](1,"nb-card-header"),h["\u0275\u0275text"](2," Gesti\xf3n de Estaciones "),h["\u0275\u0275elementStart"](3,"nb-progress-bar",1),h["\u0275\u0275text"](4),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementStart"](5,"nb-card-body"),h["\u0275\u0275elementStart"](6,"ng2-smart-table",2,3),h["\u0275\u0275listener"]("deleteConfirm",(function(e){return t.onDeleteConfirm(e)}))("editConfirm",(function(e){return t.onSaveConfirm(e)}))("createConfirm",(function(e){return t.onSaveConfirm(e)})),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"](),h["\u0275\u0275elementEnd"]()),2&e&&(h["\u0275\u0275property"]("nbSpinner",t.loading),h["\u0275\u0275advance"](3),h["\u0275\u0275property"]("value",t.progress),h["\u0275\u0275advance"](1),h["\u0275\u0275textInterpolate"](t.progress),h["\u0275\u0275advance"](2),h["\u0275\u0275property"]("settings",t.settings)("source",t.source))},directives:[r.w,r.Cb,r.z,r.ob,r.v,l.c],styles:[""]}),e}(),children:[{path:":id",component:b.a},{path:"add",component:b.a}]}],k=function(){function e(){}return e.\u0275mod=h["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=h["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[u.g.forChild(D)],u.g]}),e}(),I=n("EnSh"),j=n("QJFE"),_=n("5+WD"),z=n("DPnb"),T=n("ZAI4"),E=n("pk6O"),O=[a.g],F=function(){function e(){}return e.\u0275mod=h["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=h["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[Object(o.e)(O,[i.c,k,c.c,l.d,r.O,r.A,r.Nb,r.sb,r.L,r.Db,r.pb,r.Tb,s.e,r.R,r.t,r.m,r.Vb,I.a,j.d,_.g,r.xb,r.r,E.a,z.d.forRoot({player:T.b})])]}),e}()}}]);